/* this file is autogenerated */
#include "gps.h"
#include "usart.h"

$model.GPSs:{gps|

static void rpc_$gps.Name$_gpio_init(void)
{
  GPIO_InitTypeDef gpio;

  /* enable gpio clocks */

  /* configure NRESET as Output  */
  gpio.GPIO_Pin = $gps.NResetPin$;
#ifdef STM32F4XX
  gpio.GPIO_Mode = GPIO_Mode_OUT;
  gpio.GPIO_OType = GPIO_OType_PP;
  gpio.GPIO_PuPd = GPIO_PuPd_UP;
  gpio.GPIO_Speed = GPIO_Speed_100MHz;
#else
  gpio.GPIO_Mode = GPIO_Mode_Out_PP;
  gpio.GPIO_Speed = GPIO_Speed_50MHz;
#endif
  GPIO_Init($gps.NResetGpio$, &gpio);
\}

void rpc_$gps.Name$_set_enable(int enable)
{
  /* enable / disable the gps by pulling NRESET to high / low */
  GPIO_WriteBit($gps.NResetGpio$, $gps.NResetPin$, enable ? Bit_SET : Bit_RESET);
\}

int rpc_$gps.Name$_get_enable()
{
  return GPIO_ReadOutputDataBit($gps.NResetGpio$, $gps.NResetPin$) == Bit_SET ? 1 : 0;
\}

void rpc_$gps.Name$_init(void)
{
  /* initialize the gpios */
  rpc_$gps.Name$_gpio_init();

  /* initialize the usart */
  rpc_$gps.Usart.Name$_init();

  /* configure the usart for gps usage */
  rpc_$gps.Usart.Name$_set_baudrate(9600);

  /* enable the gps */
  //rpc_$gps.Name$_set_enable(1);
\}

};separator="\n"$
